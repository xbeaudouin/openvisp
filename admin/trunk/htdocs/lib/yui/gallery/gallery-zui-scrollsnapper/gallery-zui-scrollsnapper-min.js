YUI.add("gallery-zui-scrollsnapper",function(b){var a=function(){a.superclass.constructor.apply(this,arguments);};a.NAME="pluginScrollSnapper";a.NS="pages";a.ATTRS={snapDuration:{value:500,validator:b.Lang.isNumber},selector:{value:null},index:{value:0,lazyAdd:false,setter:function(e){var d=this.get("total"),c=Math.max(Math.floor(e),0);if(d&&(c>=d)){c=d-1;}if(this._pages){this.scrollTo(c,this.get("snapDuration"),"ease-out");}return c;}},total:{value:0}};b.namespace("zui").ScrollSnapper=b.extend(a,b.Plugin.Base,{initializer:function(){this._host=this.get("host");this._vertical=this._host._scrollsVertical;this._snapAttr=this._vertical?"offsetTop":"offsetLeft";this._snapRange=this._vertical?"offsetHeight":"offsetWidth";this._snapSource=this._vertical?"scrollY":"scrollX";this.afterHostMethod("_uiDimensionsChange",this._updateSnap);this.afterHostEvent("render",this._updatePages);this.afterHostEvent("scrollEnd",this._scrollEnded);this._updatePages();},_updateSnap:function(){this.scrollTo(this.get("index"));},_updatePages:function(){var c=this._host.get("contentBox"),d=this.get("selector");this._pages=d?c.all(d):c.get("children");this.set("total",this._pages.size());},_scrollEnded:function(d){var c=this._host._flicking;b.later(c?this.get("snapDuration"):1,this,function(){if(c){this._host._currentVelocity=0;}if(this._host.get(this._snapSource)==this._lastSnap){return;}this.snapTo(this.snapIndex());});},snapTo:function(c){this.set("index",c);},scrollTo:function(e,h,j){var c=Math.max(Math.floor(e),0),d=Math.max(h,0),g=this._pages.item(c),f=g?g.get(this._snapAttr):0,i=this._host.get(this._snapSource);if(i===f){return;}this._lastSnap=f;if(this._vertical){this._host.scrollTo(null,f,d,j);}else{this._host.scrollTo(f,null,d,j);}},next:function(){var c=this.get("index");if(c<this.get("total")-1){this.set("index",c+1);}},prev:function(){var c=this.get("index");if(c>0){this.set("index",c-1);}},snapIndex:function(){var d=this._snapAttr,g=this._snapRange,i=this._host.get(this._snapSource),f,h,c=this._pages,e=c.size();for(f=0;f<e;f++){h=c.item(f);if(i<h.get(d)+h.get(g)/2){return f;}}return null;}});},"gallery-2012.08.29-20-10",{requires:["scrollview-base","plugin"],skinnable:false});