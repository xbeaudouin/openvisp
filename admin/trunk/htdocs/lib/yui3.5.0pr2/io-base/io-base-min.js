/*
YUI 3.5.0pr2 (build 4560)
Copyright 2011 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("io-base",function(h){var c=["start","complete","end","success","failure","progress"],b=["status","statusText","responseText","responseXML"],f=h.config.win,e=f.XMLHttpRequest,g=f.XDomainRequest,d=0;function a(i){var j=this;j._uid="io:"+d++;j._init(i);h.io._map[j._uid]=j;}a.prototype={_id:0,_headers:{"X-Requested-With":"XMLHttpRequest"},_timeout:{},_init:function(k){var m=this,l,j;m.cfg=k||{};h.augment(m,h.EventTarget);for(l=0,j=c.length;l<j;++l){m.publish("io:"+c[l],h.merge({broadcast:1},k));m.publish("io-trn:"+c[l],k);}},_create:function(j,p){var o=this,m={id:h.Lang.isNumber(p)?p:o._id++,uid:o._uid},k=j.xdr,i=k&&k.use,l=(k&&k.use==="native"&&g),n=o._transport;if(!i){i=(j.form&&j.form.upload)?"iframe":"xhr";}switch(i){case"native":case"xhr":m.c=l?new g():e?new e():new ActiveXObject("Microsoft.XMLHTTP");if(f&&f.FormData&&j.data instanceof FormData){m.c.upload.onprogress=function(q){o.progress(m,q,j);};m.c.onload=function(q){o.load(m,q,j);};m.c.onerror=function(q){o.error(m,q,j);};m.upload=true;}m.transport=l?true:false;break;default:m.c=(n&&n[i])||{};m.transport=true;}return m;},_destroy:function(i){if(f&&!i.transport){if(e&&!i.upload){i.c.onreadystatechange=null;}else{if(i.upload){i.c.upload.onprogress=null;i.c.onload=null;i.c.onerror=null;}else{if(h.UA.ie&&!i.e){i.c.abort();}}}}i=i.c=null;},_evt:function(m,j,i){var o=this,k,p=i["arguments"],q=o.cfg.emitFacade,l="io:"+m,n="io-trn:"+m;if(j.e){j.c={status:0,statusText:j.e};}k=[q?{id:j.id,data:j.c,cfg:i,"arguments":p}:j.id];if(!q){if(m===c[0]||m===c[2]&&p){if(p){k.push(p);}}else{if(j.evt){k.push(j.evt);}else{k.push(j.c);}if(p){k.push(p);}}}k.unshift(l);o.fire.apply(o,k);if(i.on){k[0]=n;o.once(n,i.on[m],i.context||h);o.fire.apply(o,k);}},start:function(j,i){this._evt(c[0],j,i);},complete:function(j,i){this._evt(c[1],j,i);},end:function(j,i){this._evt(c[2],j,i);this._destroy(j);},success:function(j,i){this._evt(c[3],j,i);this.end(j,i);},failure:function(j,i){this._evt(c[4],j,i);this.end(j,i);},progress:function(k,j,i){k.evt=j;this._evt(c[5],k,i);},load:function(k,j,i){k.evt=j.target;this._evt(c[1],k,i);},error:function(k,j,i){k.evt=j;this._evt(c[4],k,i);},_retry:function(k,j,i){this._destroy(k);i.xdr.use="flash";return this.send(j,i,k.id);},_concat:function(i,j){i+=(i.indexOf("?")===-1?"?":"&")+j;return i;},setHeader:function(i,j){if(j){this._headers[i]=j;}else{delete this._headers[i];}},_setHeaders:function(j,i){i=h.merge(this._headers,i);h.Object.each(i,function(l,k){if(l!=="disable"){j.setRequestHeader(k,i[k]);}});},_startTimeout:function(j,i){var k=this;k._timeout[j.id]=f.setTimeout(function(){k._abort(j,"timeout");},i);},_clearTimeout:function(i){f.clearTimeout(this._timeout[i]);delete this._timeout[i];},_result:function(l,j){var i;try{i=l.c.status;}catch(k){i=0;}if(i>=200&&i<300||i===304||i===1223){this.success(l,j);}else{this.failure(l,j);}},_rS:function(j,i){var k=this;if(j.c.readyState===4){if(i.timeout){k._clearTimeout(j.id);}f.setTimeout(function(){k.complete(j,i);k._result(j,i);},0);}},_abort:function(j,i){if(j&&j.c){j.e=i;j.c.abort();}},send:function(l,m,k){var n,j,q,r,v,p,t=this,w=l,o={};m=m?h.Object(m):{};n=t._create(m,k);j=m.method?m.method.toUpperCase():"GET";v=m.sync;p=m.data;if((h.Lang.isObject(p)&&!p.nodeType)&&!n.upload){p=h.QueryString.stringify(p);}if(m.form){if(m.form.upload){return t.upload(n,l,m);}else{p=t._serialize(m.form,p);}}if(p){switch(j){case"GET":case"HEAD":case"DELETE":w=t._concat(w,p);p="";break;case"POST":case"PUT":m.headers=h.merge({"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},m.headers);break;}}if(n.transport){return t.xdr(w,n,m);}if(!v&&!n.upload){n.c.onreadystatechange=function(){t._rS(n,m);};}try{n.c.open(j,w,!v,m.username||null,m.password||null);t._setHeaders(n.c,m.headers||{});t.start(n,m);if(m.xdr&&m.xdr.credentials){if(!h.UA.ie){n.c.withCredentials=true;}}n.c.send(p);if(v){for(q=0,r=b.length;q<r;++q){o[b[q]]=n.c[b[q]];}o.getAllResponseHeaders=function(){return n.c.getAllResponseHeaders();};o.getResponseHeader=function(i){return n.c.getResponseHeader(i);};t.complete(n,m);t._result(n,m);return o;}}catch(s){if(n.transport){return t._retry(n,l,m);}else{t.complete(n,m);t._result(n,m);}}if(m.timeout){t._startTimeout(n,m.timeout);}return{id:n.id,abort:function(){return n.c?t._abort(n,"abort"):false;},isInProgress:function(){return n.c?(n.c.readyState%4):false;},io:t};}};h.io=function(j,i){var k=h.io._map["io:0"]||new a();return k.send.apply(k,[j,i]);};h.io.header=function(i,j){var k=h.io._map["io:0"]||new a();k.setHeader(i,j);};h.IO=a;h.io._map={};},"3.5.0pr2",{requires:["event-custom-base","querystring-stringify-simple"]});