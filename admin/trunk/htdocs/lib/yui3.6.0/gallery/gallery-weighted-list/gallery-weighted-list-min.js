YUI.add("gallery-weighted-list",function(a){(function(b){var n=b.Alea,j=b.Array,m=Math,h=j.each,l=m.floor,d=b.Lang.isFunction,f=j.iterate,e=j.map,k=n?new n().random:m.random,c=j.reduce,i=j.some,g=function(){this._array=[];};g.prototype={add:function(q,p){var o=this,r=o._array;if(!p&&p!==0){p=1;}r.push({value:q,weight:p});delete o._sum;delete o._totals;return r.length-1;},dedupe:function(s){var v=this._array,r,t,w,p,o=v.length,q={},u=new g();if(!s){s="sum";}for(r=0;r<o;r+=1){w=v[r];p=w.value;if(!q.hasOwnProperty(p)){q[p]=u.add(p,w.weight);}else{if(s==="sum"){t=q[p];u.updateWeight(t,u.weight(t)+w.weight);}}}return u;},each:function(p,o){h(this._array,function(r,q){p.call(o,r.value,q,r.weight);});return this;},every:function(p,o){return !i(this._array,function(r,q){return !p.call(o,r.value,q,r.weight);});},filter:function(q,p){var o=new g();h(this._array,function(t,r){var u=t.value,s=t.weight;if(q.call(p,u,r,s)){o.add(u,s);}});return o;},find:function(p,o){var q=null;i(this._array,function(s,r){var t=s.value;if(p.call(o,t,r,s.weight)){q=t;return true;}});return q;},grep:function(p){var o=new g();h(this._array,function(q){var r=q.value;if(p.test(r)){o.add(r,q.weight);}});return o;},indexOf:function(q,s){var o=this,r=o._array,p=-1;s=s||0;if(s<0){s+=r.length;}i(r,function(u,t){if(t<s){return false;}if(o.itemsAreEqual(u.value,q)){p=t;return true;}});return p;},invoke:function(p){var q=j(arguments,1,true),o=new g();h(this._array,function(r){var s=r.value,t=s&&s[p];o.add(d(t)?t.apply(s,q):null,r.weight);});return o;},isEmpty:function(){return !this._array.length;},item:function(o){if(!o&&o!==0){o=this._randomIndex();}var p=this._array[o];return p?{index:o,value:p.value,weight:p.weight}:null;},itemsAreEqual:function(p,o){return p===o;},lastIndexOf:function(q,t){var o=this,s=o._array,r=s.length,p=-1;if(!t&&t!==0){t=r-1;}if(t<0){t+=s.length;}f(s,-1,function(v,u){if(u>t){return false;}if(o.itemsAreEqual(v.value,q)){p=u;return true;}});return p;},map:function(q,p){var o=new g();h(this._array,function(t,r){var s=t.weight;o.add(q.call(p,t.value,r,s),t.weight);});return o;},partition:function(q,p){var r=new g(),o=new g();h(this._array,function(u,s){var v=u.value,t=u.weight;(q.call(p,v,s,t)?r:o).add(v,t);});return{matches:r,rejects:o};},reduce:function(o,q,p){return c(this._array,o,function(t,s,r){return q.call(p,t,s.value,r,s.weight);});},reject:function(q,p){var o=new g();h(this._array,function(t,r){var u=t.value,s=t.weight;if(!q.call(p,u,r,s)){o.add(u,s);}});return o;},remove:function(s,p){var r=this,t=r._array,q=0,o=t.length-1;for(;o>=0;o-=1){if(r.itemsAreEqual(s,r.value(o))){t.splice(o,1);q+=1;if(!p){break;}}}if(q){delete r._sum;delete r._totals;}return q;},removeIndex:function(o){var p=this;p._array.splice(o,1);delete p._sum;delete p._totals;return p;},size:function(){return this._array.length;},some:function(p,o){return i(this._array,function(r,q){return p.call(o,r.value,q,r.weight);});},update:function(o,r,q){var p=this;if(!q&&q!==0){q=1;}p._array[o]={value:r,weight:q};delete p._sum;delete p._totals;return p;},updateValue:function(o,p){return this.update(o,p,this.weight(o));},updateWeight:function(o,p){return this.update(o,this.value(o),p);},unique:function(p){if(!p){p="sum";}var o=new g();h(this._array,function(q){var r=q.value;if(!i(o._array,function(t,s){if(t.value===r){if(p==="sum"){o.updateWeight(s,t.weight+q.weight);}return true;}})){o.add(r,q.weight);}});return o;},toArray:function(){return e(this._array,function(o){return o.value;});},toJSON:function(){return this.toArray();},toString:function(){return this.toArray().toString();},value:function(o){if(!o&&o!==0){o=this._randomIndex();}var p=this._array[o];return p?p.value:null;},weight:function(o){if(!o&&o!==0){o=this._randomIndex();}var p=this._array[o];return p?p.weight:null;},_randomIndex:function(){var o,t=this,v,u=0,s,q=t._sum,r,p=t._totals;if(!q||!p){t._update();q=t._sum;p=t._totals;if(!q||!p||!p.length){return null;}}o=p.length-1;s=k()*q;while(o>=u){v=(o+u)/2;if(v<0){v=0;}else{v=l(v);}r=p[v];if(s===r){v+=1;break;}else{if(s<r){if(v&&s>p[v-1]){break;}o=v-1;}else{if(s>r){u=v+1;}}}}return v;},_update:function(){var q=this,p=0,o=[];h(q._array,function(r){p+=r.weight;o.push(p);});q._sum=p;q._totals=o;return q;}};b.WeightedList=g;}(a));},"gallery-2012.07.18-13-22",{requires:["array-extras","gallery-array-iterate"],skinnable:false,optional:["gallery-alea"]});